# 故障排除指南

## 常见问题和解决方案

### 1. 无法打开工具

#### 问题：双击 index.html 后页面空白或显示错误

**可能原因：**
- config.js 文件不存在
- 配置文件格式错误
- 浏览器不支持

**解决方案：**

1. **检查 config.js 是否存在**
   ```
   在 hint-generator 文件夹中查找 config.js 文件
   如果不存在，运行 setup.bat 或手动复制 config.example.js
   ```

2. **检查配置文件格式**
   - 打开 config.js
   - 确保没有语法错误
   - 确保所有引号和括号都正确闭合

3. **使用现代浏览器**
   - 推荐：Chrome、Edge、Firefox
   - 不推荐：IE（不支持）

4. **查看控制台错误**
   - 按 F12 打开开发者工具
   - 查看"控制台"标签页
   - 根据错误信息进行修复

---

### 2. 无法登录

#### 问题：输入密码后提示"密码错误"

**可能原因：**
- 密码输入错误
- config.js 中密码未设置
- 配置文件未加载

**解决方案：**

1. **确认密码**
   - 打开 config.js
   - 查看 ADMIN_PASSWORD 的值
   - 确保输入的密码与配置文件中的一致

2. **检查配置文件**
   ```javascript
   // 正确格式
   ADMIN_PASSWORD: "myPassword123",
   
   // 错误格式（缺少引号）
   ADMIN_PASSWORD: myPassword123,
   ```

3. **重新设置密码**
   - 编辑 config.js
   - 修改 ADMIN_PASSWORD 的值
   - 保存文件
   - 刷新页面（Ctrl+R）

---

### 3. AI 生成失败

#### 问题：点击"AI 生成"后提示失败

**可能原因：**
- API Key 错误或无效
- 网络连接问题
- 超过 API 使用限制
- Gemini API 服务问题

**解决方案：**

1. **检查 API Key**
   - 打开 config.js
   - 确认 GEMINI_API_KEY 是否正确
   - API Key 格式：AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

2. **验证 API Key 是否有效**
   - 访问 https://makersuite.google.com/app/apikey
   - 查看你的 API Key 状态
   - 如果无效，删除并创建新的

3. **检查网络连接**
   - 确保电脑已连接互联网
   - 尝试访问 google.com 测试网络

4. **检查 API 使用限制**
   - Gemini 免费版限制：每分钟 15 次请求
   - 如果超限，等待 1 分钟后重试
   - 查看 API 配额：https://makersuite.google.com/app/apikey

5. **查看详细错误**
   - 按 F12 打开控制台
   - 查看错误信息
   - 根据错误代码处理：
     - 400: 请求格式错误
     - 401: API Key 无效
     - 429: 超过使用限制
     - 500: 服务器错误

---

### 4. 无法同步到云端

#### 问题：点击"同步到云端"后失败

**可能原因：**
- Firebase 配置错误
- 网络连接问题
- 数据格式错误
- Firebase 权限问题

**解决方案：**

1. **检查 Firebase 配置**
   - 打开 config.js
   - 确认 FIREBASE_CONFIG 是否正确
   - 不要修改 Firebase 配置（已预填）

2. **检查网络连接**
   - 确保电脑已连接互联网
   - 尝试访问 firebase.google.com

3. **验证数据格式**
   - 确保所有必填字段都已填写
   - 确保提示词数量正确（15个）
   - 检查年份格式（数字）

4. **查看控制台错误**
   - 按 F12 打开控制台
   - 查看 Firebase 错误信息
   - 常见错误：
     - PERMISSION_DENIED: 权限问题
     - NETWORK_ERROR: 网络问题

---

### 5. 加载皇帝列表失败

#### 问题：下拉列表中没有皇帝选项

**可能原因：**
- Firebase 连接失败
- 数据库中没有数据
- 网络问题

**解决方案：**

1. **检查 Firebase 连接**
   - 按 F12 打开控制台
   - 查看是否有 Firebase 初始化错误

2. **检查数据库**
   - 访问 Firebase 控制台
   - 查看 Realtime Database
   - 确认 emperors 节点下有数据

3. **刷新页面**
   - 按 Ctrl+R 刷新
   - 重新登录

---

### 6. 生成的数据不完整

#### 问题：AI 生成的皇帝数据缺少某些字段

**可能原因：**
- AI 响应格式错误
- 网络中断
- API 限制

**解决方案：**

1. **重新生成**
   - 点击"清空"按钮
   - 重新输入皇帝名称
   - 再次点击"AI 生成"

2. **手动补充**
   - 在生成结果中手动填写缺失的字段
   - 确保所有必填字段都有值

3. **检查提示词数量**
   - 确保有 15 个提示词
   - 如果不足，可以手动添加

---

### 7. 提示词评估结果不准确

#### 问题：AI 评估的结果与实际不符

**可能原因：**
- AI 理解偏差
- 历史知识库限制
- 提示词描述不清

**解决方案：**

1. **人工审核**
   - 不要完全依赖 AI 评估
   - 结合自己的历史知识判断

2. **重新评估**
   - 点击"开始评估"重新评估
   - AI 每次评估可能略有不同

3. **手动修正**
   - 不使用"应用所有修正"
   - 手动选择需要修正的提示词

---

### 8. 浏览器兼容性问题

#### 问题：某些功能在特定浏览器中不工作

**解决方案：**

1. **使用推荐浏览器**
   - Chrome（推荐）
   - Edge（推荐）
   - Firefox（支持）
   - Safari（基本支持）
   - IE（不支持）

2. **更新浏览器**
   - 确保使用最新版本
   - Chrome: chrome://settings/help
   - Edge: edge://settings/help

3. **清除缓存**
   - Ctrl+Shift+Delete
   - 清除浏览器缓存和 Cookie
   - 刷新页面

---

### 9. 性能问题

#### 问题：工具运行缓慢或卡顿

**可能原因：**
- 网络速度慢
- AI 处理时间长
- 浏览器资源不足

**解决方案：**

1. **耐心等待**
   - AI 生成需要 10-30 秒
   - 评估需要 20-40 秒
   - 不要重复点击按钮

2. **关闭其他标签页**
   - 释放浏览器内存
   - 提高处理速度

3. **检查网络速度**
   - 使用稳定的网络连接
   - 避免在网络高峰期使用

---

### 10. 数据丢失

#### 问题：编辑的数据没有保存

**可能原因：**
- 未点击"同步到云端"
- 同步失败
- 浏览器崩溃

**解决方案：**

1. **及时同步**
   - 编辑后立即点击"同步到云端"
   - 确认看到"同步成功"提示

2. **定期备份**
   - 在 Firebase 控制台导出数据
   - 保存本地备份

3. **检查同步状态**
   - 同步后在 Firebase 控制台查看
   - 确认数据已更新

---

## 错误代码对照表

### Gemini API 错误

| 错误代码 | 含义 | 解决方案 |
|---------|------|---------|
| 400 | 请求格式错误 | 检查输入数据格式 |
| 401 | API Key 无效 | 重新生成 API Key |
| 403 | 权限不足 | 检查 API Key 权限 |
| 429 | 超过使用限制 | 等待后重试 |
| 500 | 服务器错误 | 稍后重试 |
| 503 | 服务不可用 | 稍后重试 |

### Firebase 错误

| 错误代码 | 含义 | 解决方案 |
|---------|------|---------|
| PERMISSION_DENIED | 权限被拒绝 | 检查 Firebase 规则 |
| NETWORK_ERROR | 网络错误 | 检查网络连接 |
| INVALID_DATA | 数据格式错误 | 检查数据格式 |

---

## 调试技巧

### 1. 使用浏览器控制台

```
1. 按 F12 打开开发者工具
2. 切换到"控制台"标签
3. 查看错误信息（红色）
4. 查看警告信息（黄色）
5. 查看日志信息（灰色）
```

### 2. 检查网络请求

```
1. 按 F12 打开开发者工具
2. 切换到"网络"标签
3. 重新执行操作
4. 查看 API 请求状态
5. 检查请求和响应内容
```

### 3. 查看 Firebase 数据

```
1. 访问 Firebase 控制台
2. 选择项目：guesse-81748
3. 进入 Realtime Database
4. 查看 emperors 节点
5. 验证数据是否正确
```

---

## 获取帮助

如果以上方法都无法解决问题：

1. **记录错误信息**
   - 截图错误提示
   - 复制控制台错误信息
   - 记录操作步骤

2. **检查配置**
   - 确认 config.js 格式正确
   - 确认 API Key 有效
   - 确认网络连接正常

3. **重新设置**
   - 删除 config.js
   - 重新运行 setup.bat
   - 重新配置

---

## 预防措施

1. **定期备份**
   - 每周导出 Firebase 数据
   - 保存重要配置

2. **保护 API Key**
   - 不要分享给他人
   - 定期检查使用情况
   - 如果泄露立即删除

3. **及时同步**
   - 编辑后立即同步
   - 确认同步成功

4. **保持更新**
   - 使用最新版浏览器
   - 关注 API 更新

---

**提示**：大多数问题都可以通过查看浏览器控制台的错误信息来定位和解决。
